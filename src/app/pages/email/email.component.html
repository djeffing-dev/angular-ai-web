<div class="chat-messages ai-response">
  <div class="chat-input-container  card text-white p-4">
    <h4 class="mb-4">Générateur d'email IA</h4>
    <form #loginForm="ngForm" (ngSubmit)="generateEmail()">
      <div class="row">
        <div class="col-lg-6 mb-3">
          <label for="nom" class="form-label">
            Votre nom
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Entrez votre nom complet tel qu'il doit apparaître dans la signature de l'email"
              placement="top" triggers="hover" container="body">
            </i>
          </label>
          <input type="text" class="form-control" id="nom" name="nom" aria-describedby="nomHelp"
            [(ngModel)]="emailRequest.nom" required>
          <div id="nomHelp" class="form-text">Ce nom apparaîtra dans la signature.</div>
        </div>
        <div class="col-lg-6 mb-3">
          À (Destinataire)
          <label for="destinataire" class="form-label">
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Nom ou adresse email de la personne qui recevra votre message" placement="top"
              triggers="hover" container="body"></i>
          </label>
          <input type="text" class="form-control" id="destinataire" name="destinataire"
            [(ngModel)]="emailRequest.destinataire" required>
        </div>
      </div>

      <div class="mb-3">
        <label for="objet" class="form-label">
          Objet
          <i class="bi bi-info-circle help-icon"
            ngbTooltip="Le sujet de votre email. Soyez précis et concis pour attirer l'attention du destinataire"
            placement="top" triggers="hover" container="body"></i>

        </label>
        <input type="text" class="form-control" id="objet" name="objet" aria-describedby="objetHelp"
          [(ngModel)]="emailRequest.objet">
        <div id="objetHelp" class="form-text">Un objet clair améliore les chances d'ouverture.</div>
      </div>

      <div class="mb-3">
        <label for="contexte" class="form-label">
          Contexte
          <i class="bi bi-info-circle help-icon"
            ngbTooltip="Décrivez la situation actuelle, les antécédents ou les éléments de contexte nécessaires à la compréhension de votre demande"
            placement="top" triggers="hover" container="body"></i>
        </label>
        <input type="text" class="form-control" id="contexte" aria-describedby="contexteHelp" name="contexte"
          [(ngModel)]="emailRequest.context" required>
        <div id="contexteHelp" class="form-text">Donnez le contexte pour une meilleure compréhension.</div>
      </div>

      <div class="mb-3">
        <label for="objectif" class="form-label">
          Objectif
          <i class="bi bi-info-circle help-icon"
            ngbTooltip="Quel est le but de cet email ? Que voulez-vous obtenir comme réponse ou action de la part du destinataire ?"
            placement="top" triggers="hover" container="body"></i>
        </label>
        <input type="text" class="form-control" id="objectif" aria-describedby="objectifHelp" required>
        <div id="objectifHelp" class="form-text">Définissez clairement ce que vous attendez.</div>
      </div>

      <div class="row">
        <div class="col-lg-2 col-md-2 col-sm-2 col-4 mb-3">
          <label for="langue" class="form-label">
            Langue
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Choisissez la langue dans laquelle l'email doit être rédigé. 'Auto' détectera automatiquement la langue appropriée"
              placement="top" triggers="hover" container="body"></i>
          </label>
          <select id="langue" name="langue" class="form-select" aria-label="Sélection de langue"
            [(ngModel)]="emailRequest.langue">
            <option value="auto">Auto</option>
            <option value="fr">Français</option>
            <option value="en">English</option>
            <option value="es">Español</option>
          </select>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-4 mb-3">
          <label for="taille" class="form-label">
            Taille
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Longueur souhaitée pour l'email : Court (1-2 paragraphes), Moyen (3-4 paragraphes), Long (5+ paragraphes)"
              placement="top" triggers="hover" container="body"></i>
          </label>
          <select class="form-select" id="taille" name="taille" aria-label="Sélection de taille"
            [(ngModel)]="emailRequest.taille">
            <option selected>Auto</option>
            <option value="court">Court</option>
            <option value="moyen">Moyen</option>
            <option value="long">Long</option>
          </select>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-4 mb-3">
          <label for="style" class="form-label">
            Style
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Style de rédaction : Formel (vouvoiement, langage soutenu), Informel (tutoiement, décontracté), Professionnel (équilibré, respectueux)"
              placement="top" triggers="hover" container="body"></i>

          </label>
          <select class="form-select" id="style" name="style" aria-label="Sélection de style"
            [(ngModel)]="emailRequest.style">
            <option value="auto" selected>Auto</option>
            <option value="formel">Formel</option>
            <option value="informel">Informel</option>
            <option value="professionnel">Professionnel</option>
          </select>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-4 mb-3">
          <label for="ton" class="form-label">
            Ton
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Ton à adopter : Amical (chaleureux, bienveillant), Neutre (factuel, objectif), Assertif (direct, confiant)"
              placement="top" triggers="hover" container="body"></i>

          </label>
          <select class="form-select" id="ton" name="ton" aria-label="Sélection de ton" [(ngModel)]="emailRequest.ton">
            <option value="auto" selected>Auto</option>
            <option value="amical">Amical</option>
            <option value="neutre">Neutre</option>
            <option value="assertif">Assertif</option>
          </select>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-4 mb-3">
          <label for="humeur" class="form-label">
            Humeur
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Ambiance générale : Positive (optimiste, encourageant), Neutre (équilibré), Sérieuse (grave, important)"
              placement="top" triggers="hover" container="body"></i>

          </label>
          <select class="form-select" id="humeur" name="humer" aria-label="Sélection d'humeur"
            [(ngModel)]="emailRequest.humer">
            <option value="auto" selected>Auto</option>
            <option value="positive">Positive</option>
            <option value="neutre">Neutre</option>
            <option value="serieuse">Sérieuse</option>
          </select>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-4 mb-3">
          <label for="emoji" class="form-label">
            Emoji
            <i class="bi bi-info-circle help-icon"
              ngbTooltip="Utilisation d'emojis dans l'email : Oui (emojis fréquents), Non (aucun emoji), Modéré (quelques emojis appropriés)"
              placement="top" triggers="hover" container="body"></i>
          </label>
          <select class="form-select" id="emoji" name="emoji" aria-label="Sélection emoji"
            [(ngModel)]="emailRequest.emoji">
            <option value="auto" selected>Auto</option>
            <option value="oui">Oui</option>
            <option value="non">Non</option>
            <option value="modere">Modéré</option>
          </select>
        </div>
      </div>

      <!--
          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="copie">
            <label class="form-check-label text-white" for="copie">
              <i class="bi bi-info-circle help-icon me-2"
                ngbTooltip="Cochez cette case si vous souhaitez recevoir une copie de l'email généré dans votre boîte mail"
                placement="right" triggers="hover" container="body"></i>
              M'envoyer une copie de l'email généré
            </label>
          </div>
        -->

      <div class="d-grid gap-2 d-md-flex justify-content-md-end">

        <button type="submit" class="btn btn-primary" [disabled]="!loginForm.valid" *ngIf="isLoading==false">
          <i class="bi bi-magic"></i> Générer l'email
        </button>

        <button type="submit" class="btn btn-primary" [disabled]="!loginForm.valid" *ngIf="isLoading==true">
          <div class="spinner-grow" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </button>
        <button type="reset" class="btn btn-outline-light me-md-2">Réinitialiser</button>


        <!--<button class="btn btn-primary fw-medium px-5" type="submit" [disabled]="!loginForm.valid" *ngIf="spinner == true" disabled>
            <div class="spinner-border"></div>
          </button> 

          <button class="btn btn-primary fw-medium px-5" type="submit" [disabled]="!loginForm.valid"  *ngIf="spinner == false">
            Submit & Preview
          </button>-->
      </div>
    </form>

    <hr class="my-4">

    <div class="mb-3">
      <label for="resultat" class="form-label">
        Email généré
        <i class="bi bi-info-circle help-icon"
          ngbTooltip="L'email sera généré ici. Vous pourrez ensuite le copier, le modifier ou le télécharger selon vos besoins"
          placement="top" triggers="hover" container="body"></i>

      </label>
      <textarea class="form-control ai-response" id="resultat" rows="8"  name="resultat" [(ngModel)]="resultat"
        placeholder="L'email généré apparaîtra ici..."></textarea>
      <div class="form-text">Vous pouvez copier et modifier le contenu selon vos besoins.</div>
    </div>

    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
      <button type="button" class="btn" [ngClass]="copied ? 'btn-success' : 'btn-outline-success'" (click)="copyText()">
        <i class="bi" [ngClass]="copied ? 'bi-clipboard-check' : 'bi-clipboard'"></i>
        {{ copied ? 'Copié !' : 'Copier' }}
      </button>

      <button type="button" class="btn btn-outline-warning" (click)="downloadPDF()">
        <i class="bi bi-download"></i> Télécharger
      </button>
    </div>
  </div>
</div>